"use strict";var N=Object.defineProperty;var c=(e,s)=>N(e,"name",{value:s,configurable:!0});var C=require("./get-pipe-path-BoR10qr8.cjs"),h=require("node:module"),m=require("node:path"),M=require("node:url"),y=require("get-tsconfig"),F=require("node:fs"),S=require("./index-DN-8uhc2.cjs"),R=require("./client-D6NvIMSC.cjs");const v=Object.create(null);v[".js"]=[".ts",".tsx",".js",".jsx"],v[".jsx"]=[".tsx",".ts",".jsx",".js"],v[".cjs"]=[".cts"],v[".mjs"]=[".mts"];const T=c(e=>{const[s,t]=e.split("?"),a=m.extname(s),i=v[a];if(i){const l=s.slice(0,-a.length);return i.map(r=>l+r+(t?`?${t}`:""))}},"resolveTsPath"),I=c(e=>{const s=e.indexOf(":");if(s!==-1)return e.slice(0,s)},"getScheme"),b=c(e=>e[0]==="."&&(e[1]==="/"||e[1]==="."||e[2]==="/"),"isRelativePath"),D=c(e=>b(e)||m.isAbsolute(e),"isUnixPath"),W=c(e=>{if(D(e))return!0;const s=I(e);return s&&s!=="node"},"requestAcceptsQuery"),U="file://",w=/\.([cm]?ts|[tj]sx)($|\?)/,Q=/\.json($|\?)/,B=/\/(?:$|\?)/,k=/^(?:@[^/]+\/)?[^/]+$/;exports.fileMatcher=void 0,exports.tsconfigPathsMatcher=void 0,exports.allowJs=!1;const O=c(e=>{let s=null;if(e){const t=m.resolve(e);s={path:t,config:y.parseTsconfig(t)}}else{try{s=y.getTsconfig()}catch{}if(!s)return}exports.fileMatcher=y.createFilesMatcher(s),exports.tsconfigPathsMatcher=y.createPathsMatcher(s),exports.allowJs=s?.config.compilerOptions?.allowJs??!1},"loadTsconfig"),_=c(e=>Array.from(e).length>0?`?${e.toString()}`:"","urlSearchParamsStringify"),z=`${m.sep}node_modules${m.sep}`,L=c(e=>{if(!e.startsWith("data:text/javascript,"))return e;const s=e.indexOf("?");if(s===-1)return e;const t=new URLSearchParams(e.slice(s+1));let a=t.get("filePath");if(a){const i=t.get("namespace");i&&(a+=`?namespace=${encodeURIComponent(i)}`),h._cache[a]=h._cache[e],delete h._cache[e],e=a}return e},"interopCjsExports"),A=c((e,s,t)=>{if(!(t?.filename&&w.test(t.filename))&&!exports.allowJs)return;const a=T(s);if(a)for(const i of a)try{return e(i)}catch(l){const{code:r}=l;if(r!=="MODULE_NOT_FOUND"&&r!=="ERR_PACKAGE_PATH_NOT_EXPORTED")throw l}},"resolveTsFilename"),G=[".ts",".tsx",".jsx"],j=c((e,s)=>{for(const t of G)try{return e(s+t)}catch{}},"tryExtensions"),H=c((e,s)=>(t,a,i,l)=>{const r=c(o=>e(o,a,i,l),"resolve");t=L(t);const[f,P]=t.split("?"),u=new URLSearchParams(P);if(a?.filename){const n=new URLSearchParams(a.filename.split("?")[1]).get("namespace");n&&u.append("namespace",n)}if((u.get("namespace")??void 0)!==s)return r(t);const p=_(u);if(t=f,t.startsWith(U)&&(t=M.fileURLToPath(t)),exports.tsconfigPathsMatcher&&!b(t)&&!a?.filename?.includes(z)){const o=exports.tsconfigPathsMatcher(t);for(const n of o){const x=A(r,n,a);if(x)return x+p;try{return r(n)+p}catch{const g=j(r,n)||j(r,m.resolve(n,"index"));if(g)return g+p}}}const d=A(r,t,a);if(d)return d+p;try{const o=r(t);return o+(m.isAbsolute(o)?p:"")}catch(o){const n=j(r,t)||j(r,m.resolve(t,"index"));if(n)return n+p;throw o}},"createResolveFilename"),X=`
//# sourceMappingURL=data:application/json;base64,`,$=c(()=>process.sourceMapsEnabled??!0,"shouldApplySourceMap"),E=c(({code:e,map:s})=>e+X+Buffer.from(JSON.stringify(s),"utf8").toString("base64"),"inlineSourceMap"),K=[".cts",".mts",".ts",".tsx",".jsx"],V=[".js",".cjs",".mjs"],Y=c((e,s)=>{const t=Object.assign(Object.create(null),e),a=t[".js"],i=c((l,r)=>{const[f,P]=r.split("?");if((new URLSearchParams(P).get("namespace")??void 0)!==s)return a(l,f);R.parent?.send&&R.parent.send({type:"dependency",path:f});const p=K.some(n=>f.endsWith(n)),d=V.some(n=>f.endsWith(n));if(!p&&!d)return a(l,f);let o=F.readFileSync(f,"utf8");if(f.endsWith(".cjs")){const n=S.transformDynamicImport(r,o);n&&(o=$()?E(n):n.code)}else if(p||S.isESM(o)){const n=S.transformSync(o,r,{tsconfigRaw:exports.fileMatcher?.(f)});o=$()?E(n):n.code}l._compile(o,f)},"transformer");return t[".js"]=i,[".ts",".tsx",".jsx",".mjs"].forEach(l=>{Object.defineProperty(t,l,{value:i,enumerable:!1})}),t},"createExtensions"),J=c((e,s)=>{if(!s)throw new Error("The current file path (__filename or import.meta.url) must be provided in the second argument of tsx.require()");return(typeof s=="string"&&s.startsWith("file://")||s instanceof URL)&&(s=M.fileURLToPath(s)),m.resolve(m.dirname(s),e)},"resolveContext"),Z=c(e=>{const{sourceMapsEnabled:s}=process,{_extensions:t,_resolveFilename:a}=h;O(process.env.TSX_TSCONFIG_PATH),process.setSourceMapsEnabled(!0);const i=H(a,e?.namespace);h._resolveFilename=i;const l=Y(h._extensions,e?.namespace);h._extensions=l;const r=c(()=>{s===!1&&process.setSourceMapsEnabled(!1),h._extensions=t,h._resolveFilename=a},"unregister");if(e?.namespace){const f=c((u,p)=>{const d=J(u,p),[o,n]=d.split("?"),x=new URLSearchParams(n);return e.namespace&&x.set("namespace",e.namespace),C.require(o+_(x))},"scopedRequire");r.require=f;const P=c((u,p,d)=>{const o=J(u,p),[n,x]=o.split("?"),g=new URLSearchParams(x);return e.namespace&&g.set("namespace",e.namespace),i(n+_(g),module,!1,d)},"scopedResolve");r.resolve=P,r.unregister=r}return r},"register");exports.fileUrlPrefix=U,exports.inlineSourceMap=E,exports.interopCjsExports=L,exports.isBarePackageName=k,exports.isDirectoryPattern=B,exports.isJsonPattern=Q,exports.loadTsconfig=O,exports.register=Z,exports.requestAcceptsQuery=W,exports.resolveTsPath=T,exports.tsExtensionsPattern=w;
